{"version":3,"file":"audio-worker.js","sources":["node_modules/web-worker-proxy/lib/intercept.js","node_modules/web-worker-proxy/lib/uid.js","node_modules/web-worker-proxy/lib/constants.js","node_modules/web-worker-proxy/lib/transfer.js","node_modules/web-worker-proxy/lib/create.js","node_modules/web-worker-proxy/lib/proxy.js","node_modules/web-worker-proxy/lib/persist.js","node_modules/web-worker-proxy/lib/index.js","src/utils/uid.ts","src/utils/audio-worker.ts"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = intercept;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/**\n * Intercepts actions such as property access, function call etc. and records in an array.\n */\nfunction intercept(callback) {\n  var o = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n  // We execute the promise lazily and cache it here to avoid calling again\n  var promise = void 0;\n\n  return new Proxy(o, {\n    construct: function construct(target, args) {\n      var previous = actions.slice(0, actions.length - 1);\n      var last = actions[actions.length - 1];\n\n      // It's an object construction\n      return callback([].concat(_toConsumableArray(previous), [{ type: 'construct', key: last.key, args: args }]));\n    },\n    get: function get(target, key) {\n      // Here we intercept both function calls and property access\n      // If the key was `then`, we create a `thenable` so that the result can be awaited\n      // This makes sure that the result can be used like a promise in case it's a property access\n      if (key === 'then') {\n        var then = function then(success, error) {\n          if (!promise) {\n            // If the cached promise doesn't exist, create a new promise and cache it\n            promise = callback(actions);\n          }\n\n          return promise.then(success, error);\n        };\n\n        // Return a proxy for the thenable which can be executed to get a promise\n        // If properties are accessed instead, we'll intercept them and treat them as usual\n        return intercept(callback, then, [].concat(_toConsumableArray(actions), [{ type: 'get', key: key }]));\n      }\n\n      function func() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        // It's a function call\n        return callback([].concat(_toConsumableArray(actions), [{ type: 'apply', key: key, args: args }]));\n      }\n\n      return intercept(callback, func, [].concat(_toConsumableArray(actions), [{ type: 'get', key: key }]));\n    },\n\n    /* $FlowFixMe */\n    set: function set(target, key, value) {\n      // Trigger setting the key\n      // This might fail, but we can't throw an error synchornously, so return a promise indicating the value\n      // In case of an error, the promise will be rejected and the browser will throw an error\n      // If setting the property fails in the worker, the promise will resolve to false\n      return callback([].concat(_toConsumableArray(actions), [{ type: 'set', key: key, value: value }]));\n    }\n  });\n}\n//# sourceMappingURL=intercept.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = uid;\nfunction uid() {\n  return Array.from({ length: 128 / 16 }, function () {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }).join('');\n}\n//# sourceMappingURL=uid.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ACTION_OPERATION = exports.ACTION_OPERATION = '__$$__WEB_WORKER_PROXY__ACTION_OPERATION';\nvar ACTION_DISPOSE = exports.ACTION_DISPOSE = '__$$__WEB_WORKER_PROXY__ACTION_DISPOSE';\n\nvar RESULT_SUCCESS = exports.RESULT_SUCCESS = '__$$__WEB_WORKER_PROXY__RESULT_SUCCESS';\nvar RESULT_ERROR = exports.RESULT_ERROR = '__$$__WEB_WORKER_PROXY__RESULT_ERROR';\nvar RESULT_CALLBACK = exports.RESULT_CALLBACK = '__$$__WEB_WORKER_PROXY__RESULT_CALLBACK';\n\nvar TYPE_ERROR = exports.TYPE_ERROR = '__$$__WEB_WORKER_PROXY__TYPE_ERROR';\nvar TYPE_FUNCTION = exports.TYPE_FUNCTION = '__$$__WEB_WORKER_PROXY__TYPE_FUNCTION';\nvar TYPE_PERSISTED_FUNCTION = exports.TYPE_PERSISTED_FUNCTION = '__$$__WEB_WORKER_PROXY__TYPE_PERSISTED_FUNCTION';\n\nvar MESSAGE_DISPOSED_ERROR = exports.MESSAGE_DISPOSED_ERROR = 'The function has been disposed and is no longer available.';\n//# sourceMappingURL=constants.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.serialize = serialize;\nexports.deserialize = deserialize;\n\nvar _constants = require('./constants');\n\nfunction serialize(item) {\n  if (item instanceof Error) {\n    // Since we cannot send the error object, we send necessary info to recreate it\n    return {\n      type: _constants.TYPE_ERROR,\n      name: item.constructor.name,\n      message: item.message,\n      stack: item.stack\n    };\n  }\n\n  return item;\n}\n\nfunction deserialize(item) {\n  if (item != null && item.type === _constants.TYPE_ERROR) {\n    // Try to get the global object\n    var g =\n    // DOM environment in browsers\n    typeof window !== 'undefined' ? window : // Web worker environment\n    typeof self !== 'undefined' ? self : //Node environment\n    typeof global !== 'undefined' ? // eslint-disable-next-line no-undef\n    global : null;\n\n    var name = item.name,\n        message = item.message,\n        stack = item.stack;\n\n    // If the error was for current action, reject the promise\n    // Try to preserve the error constructor, e.g. TypeError\n\n    var ErrorConstructor = g && g[name] ? g[name] : Error;\n\n    var error = new ErrorConstructor(message);\n\n    // Preserve the error stack\n    error.stack = stack;\n\n    return error;\n  }\n\n  return item;\n}\n//# sourceMappingURL=transfer.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = create;\n\nvar _intercept = require('./intercept');\n\nvar _intercept2 = _interopRequireDefault(_intercept);\n\nvar _uid = require('./uid');\n\nvar _uid2 = _interopRequireDefault(_uid);\n\nvar _transfer = require('./transfer');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Creates a proxied web worker.\n * This should be called in the DOM context.\n */\nfunction create(worker) {\n  // Send actions to the worker and wait for result\n  var send = function send(type, data) {\n    return new Promise(function (resolve, reject) {\n      // Unique id to identify the current action\n      var id = (0, _uid2.default)();\n\n      // For function calls, store any callbacks we're sending\n      var callbacks = new Map();\n\n      // Store a variable to indicate whether the task has been fulfilled\n      var fulfilled = false;\n\n      if (type === _constants.ACTION_OPERATION) {\n        var last = data[data.length - 1];\n\n        if (last.type === 'apply') {\n          // If we have a function call, map callbacks in the function call to refs\n          /* $FlowFixMe */\n          last.args = last.args.map(function (arg) {\n            // If the argument is a callback function, we create a ref and store the function\n            // We also replace the argument with the ref instead\n            // Otherwise we just return it\n            if (typeof arg === 'function') {\n              var ref = (0, _uid2.default)();\n              callbacks.set(ref, arg);\n              return {\n                type: _constants.TYPE_FUNCTION,\n                ref: ref\n              };\n            }\n\n            // Persisted functions are like normal functions, but can be called multiple times\n            // We clean it up only when the user disposes it\n            if (arg != null && arg.type === _constants.TYPE_PERSISTED_FUNCTION) {\n              var _ref = (0, _uid2.default)();\n              callbacks.set(_ref, arg);\n\n              // Add a listener to the persisted function to listen for dispose\n              // When the function is disposed, we delete it and remove the listeners\n              // We also notify the worker that this function is disposed and can no longer be called\n              arg.on('dispose', function () {\n                callbacks.delete(_ref);\n                removeListener();\n\n                worker.postMessage({\n                  type: _constants.ACTION_DISPOSE,\n                  ref: _ref\n                });\n              });\n\n              return {\n                type: _constants.TYPE_FUNCTION,\n                ref: _ref,\n                persisted: true\n              };\n            }\n\n            return (0, _transfer.serialize)(arg);\n          });\n        } else if (last.type === 'set') {\n          last.value = (0, _transfer.serialize)(last.value);\n        }\n      }\n\n      // Listener to handle incoming messages from the worker\n      var listener = function listener(e) {\n        switch (e.data.type) {\n          case _constants.RESULT_SUCCESS:\n            if (e.data.id === id) {\n              // If the success result was for current action, resolve the promise\n              resolve((0, _transfer.deserialize)(e.data.result));\n\n              fulfilled = true;\n\n              removeListener();\n            }\n\n            break;\n\n          case _constants.RESULT_ERROR:\n            if (e.data.id === id) {\n              reject((0, _transfer.deserialize)(e.data.error));\n\n              fulfilled = true;\n\n              removeListener();\n            }\n\n            break;\n\n          case _constants.RESULT_CALLBACK:\n            if (e.data.id === id) {\n              // Get the referenced callback\n              var _e$data$func = e.data.func,\n                  ref = _e$data$func.ref,\n                  args = _e$data$func.args;\n\n              var callback = callbacks.get(ref);\n\n              if (callback) {\n                callback.apply(null, args.map(_transfer.deserialize));\n\n                if (callback.type !== _constants.TYPE_PERSISTED_FUNCTION) {\n                  // Remove the callback if it's not persisted\n                  callbacks.delete(ref);\n                }\n              } else {\n                // Function is already disposed\n                // This shouldn't happen\n              }\n\n              removeListener();\n            }\n        }\n      };\n\n      var removeListener = function removeListener() {\n        if (callbacks.size === 0 && fulfilled) {\n          // Remove the listener once there are no callbacks left and task is fulfilled\n          worker.removeEventListener('message', listener);\n        }\n      };\n\n      worker.addEventListener('message', listener);\n      worker.postMessage({ type: type, id: id, data: data });\n    });\n  };\n\n  return (0, _intercept2.default)(function (operations) {\n    return send(_constants.ACTION_OPERATION, operations);\n  });\n}\n//# sourceMappingURL=create.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = proxy;\n\nvar _constants = require('./constants');\n\nvar _transfer = require('./transfer');\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar proxies = new WeakMap();\n\n/**\n * Proxies an object inside an worker.\n * This should be called inside an worker.\n */\nfunction proxy(o) {\n  var target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : self;\n\n  if (proxies.has(target)) {\n    throw new Error('The specified target already has a proxy. To create a new proxy, call `dispose` first to dispose the previous proxy.');\n  }\n\n  proxies.set(target, true);\n\n  // List of persisted function refs\n  var persisted = [];\n\n  // Listen to messages from the client\n  var listener = function listener(e) {\n    switch (e.data.type) {\n      case _constants.ACTION_OPERATION:\n        {\n          (function () {\n            var _e$data = e.data,\n                id = _e$data.id,\n                data = _e$data.data;\n\n\n            try {\n              var result = o;\n\n              var _iteratorNormalCompletion = true;\n              var _didIteratorError = false;\n              var _iteratorError = undefined;\n\n              try {\n                for (var _iterator = data[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  var action = _step.value;\n\n                  if (action.type === 'get') {\n                    result = result[action.key];\n                  } else if (action.type === 'set') {\n                    // Reflect.set will return a boolean to indicate if setting the property was successful\n                    // Setting the property might fail if the object is read only\n                    result = Reflect.set(result, action.key, (0, _transfer.deserialize)(action.value));\n                  } else if (action.type === 'apply') {\n                    var prop = result[action.key];\n\n                    if (typeof prop !== 'function') {\n                      throw new TypeError(action.key + ' is not a function');\n                    } else {\n                      result = prop.apply(undefined, _toConsumableArray(action.args.map(function (arg) {\n                        if (arg != null && arg.type === _constants.TYPE_FUNCTION) {\n                          // If we find a ref for a function, replace it with a custom function\n                          // This function can notify the parent when it receives arguments\n                          return function () {\n                            var called = false;\n\n                            if (arg.persisted) {\n                              // If the function is persisted, add it to the persisted list\n                              persisted.push(arg.ref);\n                            }\n\n                            return function () {\n                              for (var _len = arguments.length, params = Array(_len), _key = 0; _key < _len; _key++) {\n                                params[_key] = arguments[_key];\n                              }\n\n                              if (called && !persisted.includes(arg.ref)) {\n                                // If function was called before and is no longer persisted, don't send results back\n                                throw new Error(_constants.MESSAGE_DISPOSED_ERROR);\n                              }\n\n                              called = true;\n                              target.postMessage({\n                                type: _constants.RESULT_CALLBACK,\n                                id: id,\n                                func: {\n                                  args: params.map(_transfer.serialize),\n                                  ref: arg.ref\n                                }\n                              });\n                            };\n                          }();\n                        }\n\n                        return (0, _transfer.deserialize)(arg);\n                      })));\n                    }\n                  } else {\n                    throw new Error('Unsupported operation \"' + action.type + '\"');\n                  }\n                }\n\n                // If result is a thenable, resolve the result before sending\n                // This allows us to support results which are promise-like\n                /* $FlowFixMe */\n              } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                  }\n                } finally {\n                  if (_didIteratorError) {\n                    throw _iteratorError;\n                  }\n                }\n              }\n\n              if (result && typeof result.then === 'function') {\n                Promise.resolve(result).then(function (r) {\n                  return target.postMessage({\n                    type: _constants.RESULT_SUCCESS,\n                    id: id,\n                    result: (0, _transfer.serialize)(r)\n                  });\n                }, function (e) {\n                  return target.postMessage({\n                    type: _constants.RESULT_ERROR,\n                    id: id,\n                    error: (0, _transfer.serialize)(e)\n                  });\n                });\n              } else {\n                target.postMessage({\n                  type: _constants.RESULT_SUCCESS,\n                  id: id,\n                  result: (0, _transfer.serialize)(result)\n                });\n              }\n            } catch (e) {\n              target.postMessage({\n                type: _constants.RESULT_ERROR,\n                id: id,\n                error: (0, _transfer.serialize)(e)\n              });\n            }\n          })();\n        }\n\n        break;\n\n      case _constants.ACTION_DISPOSE:\n        {\n          // Remove the callback ref from persisted list when it's disposed\n          var index = persisted.indexOf(e.data.ref);\n\n          if (index > -1) {\n            persisted.splice(index, 1);\n          }\n        }\n\n        break;\n    }\n  };\n\n  target.addEventListener('message', listener);\n\n  return {\n    // Return a method to dispose the proxy\n    // Disposing will remove the listeners and the proxy will stop working\n    dispose: function dispose() {\n      target.removeEventListener('message', listener);\n      proxies.delete(target);\n    }\n  };\n}\n//# sourceMappingURL=proxy.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = persist;\n\nvar _constants = require('./constants');\n\n/**\n * Persist a callback function so it can be called multiple times\n */\nfunction persist(func) {\n  var listeners = [];\n\n  var disposed = false;\n\n  return {\n    type: _constants.TYPE_PERSISTED_FUNCTION,\n    apply: function apply(that, args) {\n      if (disposed) {\n        throw new Error(_constants.MESSAGE_DISPOSED_ERROR);\n      }\n\n      return func.apply(that, args);\n    },\n    dispose: function dispose() {\n      listeners.forEach(function (listener) {\n        return listener();\n      });\n      disposed = true;\n    },\n    on: function on(name, cb) {\n      if (name === 'dispose') {\n        listeners.push(cb);\n      }\n    },\n\n    get disposed() {\n      return disposed;\n    }\n  };\n}\n//# sourceMappingURL=persist.js.map","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _create = require('./create');\n\nObject.defineProperty(exports, 'create', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_create).default;\n  }\n});\n\nvar _proxy = require('./proxy');\n\nObject.defineProperty(exports, 'proxy', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_proxy).default;\n  }\n});\n\nvar _persist = require('./persist');\n\nObject.defineProperty(exports, 'persist', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_persist).default;\n  }\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=index.js.map","const words = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nexport default function genUid(length = 16) {\n    let result = '';\n    for (let i = 0; i < length; i++) {\n        const r = Math.floor(Math.random() * words.length);\n        result += words[r];\n    }\n    return result;\n}\n","/**\n * @fileoverview\n * WebWorker side of audio decoder.\n */\nimportScripts('../amrnb.min.js', '../silksdk.js');\nimport { proxy } from 'web-worker-proxy';\nimport genUid from './uid';\nlet SilkSDK = self;\nSilkSDK.print = (a) => console.log('[OneUI-Audio]', a);\nSilkSDK.printErr = (a) => console.error('[OneUI-Audio]', a);\nfunction decodeAMR(data) {\n    SilkSDK.print('Decoding AMR audio');\n    const startTime = Date.now();\n    const decoder = new self.AMR({});\n    const result = decoder.decode(data);\n    decoder.close();\n    SilkSDK.print(`Finished decoding AMR audio in ${Date.now() - startTime} ms`);\n    return result;\n}\nfunction decodeSilkV3(data) {\n    if (!SilkSDK) {\n        throw new Error('SilkSDK is not ready.');\n    }\n    const startTime = Date.now();\n    SilkSDK.print('Decoding SilkV3 audio');\n    const sourceFile = genUid() + '.bit';\n    const destFile = genUid() + '.pcm';\n    SilkSDK.FS.writeFile(sourceFile, data);\n    SilkSDK.callMain([sourceFile, destFile]);\n    const result = SilkSDK.FS.readFile(destFile);\n    SilkSDK.FS.unlink(sourceFile);\n    SilkSDK.FS.unlink(destFile);\n    const a = new Float32Array(result.length);\n    for (let i = 0; i < a.length; i++) {\n        a[i] = result[i] / 32768;\n    }\n    SilkSDK.print(`Finished decoding SilkV3 audio in ${Date.now() - startTime} ms`);\n    return a;\n}\nconst workerProxy = {\n    decodeAMR,\n    decodeSilkV3\n};\nproxy(workerProxy);\nSilkSDK.print('WebWorker is ready!');\nSilkSDK.print('OneUI-Audio is ready!');\n"],"names":["intercept","callback","o","arguments","length","undefined","actions","promise","Proxy","construct","target","args","previous","slice","last","concat","_toConsumableArray","type","key","get","success","error","then","_len","Array","_key","set","value","arr","isArray","i","arr2","from","Math","floor","random","toString","substring","join","Object","defineProperty","exports","item","Error","_constants","TYPE_ERROR","name","constructor","message","stack","g","window","self","global","worker","_intercept2","default","operations","ACTION_OPERATION","data","Promise","resolve","reject","id","_uid2","callbacks","Map","fulfilled","map","arg","ref","TYPE_FUNCTION","TYPE_PERSISTED_FUNCTION","_ref","on","delete","removeListener","postMessage","ACTION_DISPOSE","persisted","_transfer","serialize","listener","e","RESULT_SUCCESS","deserialize","result","RESULT_ERROR","RESULT_CALLBACK","_e$data$func","func","apply","size","removeEventListener","addEventListener","_interopRequireDefault","_intercept","_uid","obj","__esModule","proxies","has","_e$data","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","action","Reflect","prop","TypeError","called","push","params","includes","MESSAGE_DISPOSED_ERROR","err","return","r","index","indexOf","splice","dispose","WeakMap","listeners","disposed","that","forEach","cb","enumerable","_create","_proxy","_persist","words","genUid","importScripts","SilkSDK","print","a","console","log","printErr","workerProxy","decodeAMR","startTime","Date","now","decoder","AMR","decode","close","decodeSilkV3","sourceFile","destFile","FS","writeFile","callMain","readFile","unlink","Float32Array"],"mappings":"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"}